jQuery.fn.extend({extm:function(e){function t(e,t){if(sW=t.width(),sH=t.height(),offset=t.offset(),"undefined"==typeof e.zoomElement){var s=$("<div style='overflow:hidden;pointer-events:none;height:"+sH+"px;width:"+sW+"px;' class='extm'></div>");"undefined"!=typeof e.position?(s.appendTo($("body")),"right"==e.position?(s.css("position","absolute"),s.css("top",offset.top),s.css("left",offset.left+sW)):"overlay"==e.position&&(s.css("position","absolute"),s.css("top",offset.top),s.css("left",offset.left))):s.insertAfter(t)}else var s=e.zoomElement;if("undefined"!=typeof e.squareOverlay&&e.squareOverlay===!0){var i=$("<div class='overlayElement' style='pointer-events:none;height:"+sH+"px;width:"+sW+"px;position:absolute;top:"+offset.top+"px;left:"+offset.left+"px;'></div>");i.insertAfter(t);var o=$("<div style='background-color:rgba(0,0,0,0.2);visibility:hidden;position:absolute;' class='innerOverlay'></div>");i.append(o);var n=!0}("undefined"==typeof e.lazy||1!=e.lazy)&&s.css("visibility","hidden");var f=$('<img style="position:relative;">');"undefined"==typeof e.imageSrc?f.attr("src",t.attr("src")):f.attr("src",e.imageSrc),f.appendTo(s),function(t,s,i,f,a,l,r){i.load(function(){t.on("mouseenter",function(){s.css("visibility","visible"),n===!0&&o.css("visibility","visible")}),t.on("mouseleave",function(){s.css("visibility","hidden"),n===!0&&o.css("visibility","hidden")});var r=i.width(),d=i.height(),p=r/l,h=d/a,c=0-(r-s.width()),v=0-(d-s.height());if(n===!0){var u=l/r*l,m=a/d*a;o.css("height",m),o.css("width",u)}t.on("mousemove",function(r){var d=t.offset();"undefined"!=typeof e.position&&("right"==e.position?(s.css("top",d.top),s.css("left",d.left+l)):"overlay"==e.position&&(s.css("top",d.top),s.css("left",d.left))),"undefined"!=typeof e.squareOverlay&&e.squareOverlay===!0&&(f.css("top",d.top),f.css("left",d.left));var y=a/2-(r.pageY-d.top)*h;if(y=Math.max(y,v),y=Math.min(y,0),setLeft=l/2-(r.pageX-d.left)*p,setLeft=Math.max(setLeft,c),setLeft=Math.min(setLeft,0),i.css("top",y),i.css("left",setLeft),n===!0){var g=r.pageY-d.top-o.height()/2;g=Math.max(g,0),g=Math.min(g,a-m),squareLeft=r.pageX-d.left-o.width()/2,squareLeft=Math.max(squareLeft,0),squareLeft=Math.min(squareLeft,l-u),o.css("top",g),o.css("left",squareLeft)}})})}(t,s,f,i,sH,sW,offset),t.on("extmdestroy",function(){s.remove()})}if("undefined"==typeof e)var e={};"undefined"!=typeof e.lazy&&e.lazy===!0?this.one("mouseenter",function(){t(e,$(this))}):t(e,this)},extmDestroy:function(){this.trigger("extmdestroy")}});