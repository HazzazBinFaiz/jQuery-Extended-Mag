jQuery.fn.extend({extm:function(t){function e(t,e){if(sW=e.width(),sH=e.height(),offset=e.offset(),t.zoomElement)var s=t.zoomElement;else{var s=$("<div style='overflow:hidden;pointer-events:none;height:"+sH+"px;width:"+sW+"px;' class='extm'></div>");"right"==t.position?(s.appendTo($("body")),s.css("position","absolute"),s.css("top",offset.top),s.css("left",offset.left+sW)):"overlay"==t.position?(s.appendTo($("body")),s.css("position","absolute"),s.css("top",offset.top),s.css("left",offset.left)):s.insertAfter(e)}if(t.squareOverlay){var i=$("<div class='overlayElement' style='pointer-events:none;height:"+sH+"px;width:"+sW+"px;position:absolute;top:"+offset.top+"px;left:"+offset.left+"px;'></div>");i.insertAfter(e);var o=$("<div style='background-color:rgba(0,0,0,0.2);visibility:hidden;position:absolute;' class='innerOverlay'></div>");i.append(o)}t.lazy||s.css("visibility","hidden");var a=$('<img style="position:relative;">');t.imageSrc?a.attr("src",t.imageSrc):a.attr("src",e.attr("src")),a.appendTo(s),function(e,s,i,a,l,r,n){i.load(function(){e.on("mouseenter",function(){var i=e.offset();"right"==t.position?(s.css("top",i.top),s.css("left",i.left+r)):"overlay"==t.position&&(s.css("top",i.top),s.css("left",i.left)),t.squareOverlay&&(a.css("top",i.top),a.css("left",i.left)),s.css("visibility","visible"),t.squareOverlay&&o.css("visibility","visible")}),e.on("mouseleave",function(){s.css("visibility","hidden"),t.squareOverlay&&o.css("visibility","hidden")});var n=i.width(),f=i.height(),h=n/r,p=f/l,c=0-(n-s.width()),v=0-(f-s.height());if(t.squareOverlay){var d=r/n*r,m=l/f*l;o.css("height",m),o.css("width",d)}e.on("mousemove",function(s){var a=e.offset(),n=l/2-(s.pageY-a.top)*p;if(n=Math.max(n,v),n=Math.min(n,0),setLeft=r/2-(s.pageX-a.left)*h,setLeft=Math.max(setLeft,c),setLeft=Math.min(setLeft,0),i.css("top",n),i.css("left",setLeft),t.squareOverlay){var f=s.pageY-a.top-o.height()/2;f=Math.max(f,0),f=Math.min(f,l-m),squareLeft=s.pageX-a.left-o.width()/2,squareLeft=Math.max(squareLeft,0),squareLeft=Math.min(squareLeft,r-d),o.css("top",f),o.css("left",squareLeft)}})})}(e,s,a,i,sH,sW,offset),e.on("extmdestroy",function(){s.remove(),t.squareOverlay&&i.remove()})}var s={zoomElement:!1,imageSrc:$(this).attr("src"),squareOverlay:!1,position:!1,lazy:!1},i=$.extend({},s,t||{});i.lazy?this.one("mouseenter",function(){e(i,$(this))}):e(i,this)},extmDestroy:function(){this.trigger("extmdestroy")}});
