!function(t){"use strict";t.fn.extend({extm:function(e){function i(e,i){var s,o=i.width(),n=i.height(),a=i.offset();e.zoomElement?s=e.zoomElement:(s=t("<div style='overflow:hidden;pointer-events:none;height:"+n+"px;width:"+o+"px;' class='extm'></div>"),"right"===e.position?(s.appendTo(t("body")),s.css("position","absolute"),s.css("top",a.top),s.css("left",a.left+o)):"overlay"===e.position?(s.appendTo(t("body")),s.css("position","absolute"),s.css("top",a.top),s.css("left",a.left)):s.insertAfter(i));var r,l;e.squareOverlay&&(r=t("<div class='overlayElement' style='pointer-events:none;height:"+n+"px;width:"+o+"px;position:absolute;top:"+a.top+"px;left:"+a.left+"px;'></div>"),t("body").append(r),l=t("<div style='background-color:rgba(0,0,0,0.2);visibility:hidden;position:absolute;' class='innerOverlay'></div>"),r.append(l)),e.lazy||s.css("visibility","hidden");var c=t('<img style="position:relative;max-width:none;">');e.imageSrc?c.attr("src",e.imageSrc):c.attr("src",i.attr("src")),c.appendTo(s),function(t,e,i,s,o,n,a,r,l){i.load(function(){t.on("mouseenter",function(){a=t.offset(),"right"===l.position?(e.css("top",a.top),e.css("left",a.left+n)):"overlay"===l.position&&(e.css("top",a.top),e.css("left",a.left)),l.squareOverlay&&(s.css("top",a.top),s.css("left",a.left)),e.css("visibility","visible"),l.squareOverlay&&r.css("visibility","visible")}),t.on("mouseleave",function(){e.css("visibility","hidden"),l.squareOverlay&&r.css("visibility","hidden")});var c=i.width(),p=i.height(),h=c/n,v=p/o,d=0-(c-e.width()),f=0-(p-e.height());if(l.squareOverlay){var m=n/c*n,u=o/p*o;r.css("height",u),r.css("width",m)}t.on("mousemove",function(e){a=t.offset();var s=o/2-(e.pageY-a.top)*v;s=Math.max(s,f),s=Math.min(s,0);var c=n/2-(e.pageX-a.left)*h;if(c=Math.max(c,d),c=Math.min(c,0),i.css("top",s),i.css("left",c),l.squareOverlay){var p=e.pageY-a.top-r.height()/2;p=Math.max(p,0),p=Math.min(p,o-r.height());var m=e.pageX-a.left-r.width()/2;m=Math.max(m,0),m=Math.min(m,n-r.width()),r.css("top",p),r.css("left",m)}})})}(i,s,c,r,n,o,a,l,e),i.on("extmdestroy",function(){s.remove(),e.squareOverlay&&r.remove()})}var s={zoomElement:!1,imageSrc:t(this).attr("src"),squareOverlay:!1,position:!1,lazy:!1},o=t.extend({},s,e||{});o.lazy?t(this).one("load",function(){t(this).one("mouseenter",function(){i(o,t(this))})}):t(this).one("load",function(){i(o,t(this))})},extmDestroy:function(){t(this).trigger("extmdestroy")}})}(jQuery);
